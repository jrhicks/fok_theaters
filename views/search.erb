<HTML>
<head>
<title>Forks Over Knives</title>
<style>
h1 {
  padding-top: .5em;
  font-size: 26px;
  font-style: normal;
  font-weight: 400;
  text-shadow: none;
  text-decoration: none;
  text-transform: none;
  letter-spacing: 0em;
  word-spacing: 0em;
  line-height: 1;
  padding-bottom: 0;
  margin-bottom: .5em;
}
h2 {
  font-size: 20px;
  font-style: normal;
  font-weight: 400;
  text-shadow: none;
  text-decoration: none;
  text-transform: none;
  letter-spacing: 0em;
  word-spacing: 0em;
  line-height: 1;
}

body {
font:normal 12px/20px "Lucida Grande", Verdana, Arial, sans-serif;
color:#baae99;
background:#03050c url(bodybg.jpg) no-repeat fixed center top;
margin:0;
padding:0 0 15px 0;}

#wrapper {color: 080a16; background:url(headerbg.gif) repeat-x center top;}
#header {position:relative; height:100px; background:url(headerfuzz.gif) no-repeat center top;}

</style>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script> 
<%if false%><script src="http://maps.google.com/maps?file=api&v=2&key=<%=GOOGLE_API_CODE%>" type="text/javascript"></script><%end%>
</head>

<script type="text/javascript">
	var directionDisplay;
	var directionsService = new google.maps.DirectionsService();
	var map;

	<% for theater in THEATERS %>
		var mark<%=theater.object_id%>;
	<%end %>

	function load_points() {
		map.addControl(new GSmallMapControl());
		map.addControl(new GMapTypeControl());
		
		<% for t in @results %>
		var point = new GLatLng(<%=t[:latitude]%>,<%=t[:longitude]%>);
		bounds.extend(point);
		mark<%=t.object_id%> = new GMarker(point);
		GEvent.addListener(mark<%=t.object_id%>, "click", function() {
			map.setCenter(new GLatLng(<%=t[:latitude]%>, <%=t[:longitude]%>));
			mark<%=t.object_id%>.openInfoWindowHtml("<%=t[:name]%>");
			});
		map.addOverlay(mark<%=t.object_id%>);
		<%end %>
		map.setCenter(bounds.getCenter(), map.getBoundsZoomLevel(bounds));
		};
		<% for t in @results %>
		function locate<%=t.object_id%>() {
		map.closeInfoWindow();
		map.setCenter(map.getCenter(), 5);
		map.panTo(new GLatLng(<%=t[:latitude]%>, <%=t[:longitude]%>)) ;
		window.setTimeout(function() {
		mark<%=t.object_id%>.openInfoWindowHtml("<%=t.object_id%>");
		}, 2000);
		};
	
	
	function initialize() {
	  directionsDisplay = new google.maps.DirectionsRenderer();
	  var source = new google.maps.LatLng(<%=@source_lat%>, <%=@source_lon%>);
	  var myOptions = {
		zoom:7,
		mapTypeId: google.maps.MapTypeId.ROADMAP,
		center: source
	  }
	  map = new google.maps.Map(document.getElementById("map"), myOptions);
	  directionsDisplay.setMap(map);
	  calcRoute();
	  loadPoints();
	}

	function calcRoute() {
	  var start = "<%=params[:address]%>";
	  var end = "<%=@nearest[:address]%> <%=@nearest[:city]%>  <%=@nearest[:state]%>";
	  var request = {
		origin:start,
		destination:end,
		travelMode: google.maps.TravelMode.DRIVING
	  };
	  directionsService.route(request, function(result, status) {
		if (status == google.maps.DirectionsStatus.OK) {
		  directionsDisplay.setDirections(result);
		}
	  });
	}	

</script>



<body style="margin: 0px; padding: 0px;" onLoad="initialize();">
	
	<div style="width: 100%; text-align: center;" id="wrapper">
	<div id="header">
		<h1>Forks Over Knives - Nearest Theater</h1><br><br>
	</div>
	</div>

	<div style="width: 100%; text-align: center;">
		<form action="search">
			<input type="text"value="Your Address" name="address" size="50" onfocus="this.value='';"> <input type="submit" value="Go"><br><br>
		</form>
	</div>
	
	
	<div id="map" style="width:520px; height: 400px; margin: auto;"></div>
	<br>
	<div id="result" style="width:520px; margin: auto;"></div>
	<br>
	
	<p style="width: 520px; margin: auto;">

	After months of worsening conditions with ineffective treatments, my loved sister is curing her Sarcoidosis thanks to a plant-strong diet. Thank You Doctors!<BR><BR>
	<br><br>
	Twitter: @jrhicks


	<p>
</body>

</html>